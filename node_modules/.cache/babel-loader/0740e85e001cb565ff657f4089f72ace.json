{"ast":null,"code":"import _slicedToArray from\"D:/React2/React Router/Practice/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useEffect,useState}from\"react\";import classes from\"./Comments.module.css\";import NewCommentForm from\"./NewCommentForm\";import CommentsList from\"./CommentsList\";import useHttp from\"../../hooks/use-http\";import{useHistory,useLocation,useParams,useRouteMatch}from\"react-router-dom\";import LoadingSpinner from\"../ui/LoadingSpinner\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Comments=function Comments(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isAddingComment=_useState2[0],setIsAddingComment=_useState2[1];var startAddCommentHandler=function startAddCommentHandler(){setIsAddingComment(true);};//////////\nvar params=useParams();var history=useHistory();var match=useRouteMatch();var location=useLocation();var _useHttp=useHttp(),isLoading=_useHttp.isLoading,error=_useHttp.error,sendComment=_useHttp.requestFn;////////////\nvar _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),supmitComment=_useState4[0],setSubmitComment=_useState4[1];var addCommentHandler=function addCommentHandler(commentText){var transformData=function transformData(data){setSubmitComment(true);};sendComment({url:\"https://react-router-fcb08-default-rtdb.firebaseio.com/comments.json\",method:\"POST\",body:{quote:params.quoteId,text:commentText}},transformData);};useEffect(function(){if(!isLoading&&!error&&supmitComment){history.replace(\"/all-quotes/\".concat(match.params.quoteId));}},[error,isLoading,supmitComment,history,match.params.quoteId]);///////////////\n/////////\nvar _useHttp2=useHttp(),isload=_useHttp2.isLoading,err=_useHttp2.error,getComments=_useHttp2.requestFn;var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),allComments=_useState6[0],setAllComments=_useState6[1];useEffect(function(){var transformData=function transformData(data){var loadedArray=[];Object.entries(data).map(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];return loadedArray.push({id:key,text:value.text,quote:value.quote});});setAllComments(loadedArray);};getComments({url:\"https://react-router-fcb08-default-rtdb.firebaseio.com/comments.json\"},transformData);},[getComments]);var comments;if(isload){comments=/*#__PURE__*/_jsxs(\"div\",{className:\"centered\",children:[/*#__PURE__*/_jsx(LoadingSpinner,{}),\" \"]});}if(!isload&&!err&&allComments.length>0){comments=/*#__PURE__*/_jsx(CommentsList,{comments:allComments});}if(!isload&&!err&&allComments.length===0){comments=/*#__PURE__*/_jsx(\"p\",{className:\"centered\",children:\"no comments were added yet\"});}//////////\nreturn/*#__PURE__*/_jsxs(\"section\",{className:classes.comments,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"User Comments\"}),!isAddingComment&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:startAddCommentHandler,children:\"Add a Comment\"}),isAddingComment&&/*#__PURE__*/_jsx(NewCommentForm,{isLoading:isLoading,onAddComment:addCommentHandler,error:error}),comments]});};export default Comments;","map":{"version":3,"names":["useCallback","useEffect","useState","classes","NewCommentForm","CommentsList","useHttp","useHistory","useLocation","useParams","useRouteMatch","LoadingSpinner","Comments","isAddingComment","setIsAddingComment","startAddCommentHandler","params","history","match","location","isLoading","error","sendComment","requestFn","supmitComment","setSubmitComment","addCommentHandler","commentText","transformData","data","url","method","body","quote","quoteId","text","replace","isload","err","getComments","allComments","setAllComments","loadedArray","Object","entries","map","key","value","push","id","comments","length"],"sources":["D:/React2/React Router/Practice/src/components/comments/Comments.js"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\n\nimport classes from \"./Comments.module.css\";\nimport NewCommentForm from \"./NewCommentForm\";\nimport CommentsList from \"./CommentsList\";\nimport useHttp from \"../../hooks/use-http\";\nimport {\n  useHistory,\n  useLocation,\n  useParams,\n  useRouteMatch,\n} from \"react-router-dom\";\nimport LoadingSpinner from \"../ui/LoadingSpinner\";\n\nconst Comments = () => {\n  const [isAddingComment, setIsAddingComment] = useState(false);\n\n  const startAddCommentHandler = () => {\n    setIsAddingComment(true);\n  };\n  //////////\n  const params = useParams();\n  const history = useHistory();\n  const match = useRouteMatch();\n  const location = useLocation();\n  const { isLoading, error, requestFn: sendComment } = useHttp();\n  ////////////\n  const [supmitComment, setSubmitComment] = useState(false);\n  const addCommentHandler = (commentText) => {\n    const transformData = (data) => {\n      setSubmitComment(true);\n    };\n    sendComment(\n      {\n        url: \"https://react-router-fcb08-default-rtdb.firebaseio.com/comments.json\",\n        method: \"POST\",\n        body: { quote: params.quoteId, text: commentText },\n      },\n      transformData\n    );\n  };\n\n  useEffect(() => {\n    if (!isLoading && !error && supmitComment) {\n      history.replace(`/all-quotes/${match.params.quoteId}`);\n    }\n  }, [error, isLoading, supmitComment, history, match.params.quoteId]);\n\n  ///////////////\n  /////////\n  const { isLoading: isload, error: err, requestFn: getComments } = useHttp();\n  const [allComments, setAllComments] = useState([]);\n  useEffect(() => {\n    const transformData = (data) => {\n      const loadedArray = [];\n      Object.entries(data).map(([key, value]) => {\n        return loadedArray.push({\n          id: key,\n          text: value.text,\n          quote: value.quote,\n        });\n      });\n      setAllComments(loadedArray);\n    };\n    getComments(\n      {\n        url: \"https://react-router-fcb08-default-rtdb.firebaseio.com/comments.json\",\n      },\n      transformData\n    );\n  }, [getComments]);\n\n  let comments;\n  if (isload) {\n    comments = (\n      <div className=\"centered\">\n        <LoadingSpinner />{\" \"}\n      </div>\n    );\n  }\n  if (!isload && !err && allComments.length > 0) {\n    comments = <CommentsList comments={allComments} />;\n  }\n  if (!isload && !err && allComments.length === 0) {\n    comments = <p className=\"centered\">no comments were added yet</p>;\n  }\n  //////////\n  return (\n    <section className={classes.comments}>\n      <h2>User Comments</h2>\n      {!isAddingComment && (\n        <button className=\"btn\" onClick={startAddCommentHandler}>\n          Add a Comment\n        </button>\n      )}\n      {isAddingComment && (\n        <NewCommentForm\n          isLoading={isLoading}\n          onAddComment={addCommentHandler}\n          error={error}\n        />\n      )}\n      {comments}\n    </section>\n  );\n};\n\nexport default Comments;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}